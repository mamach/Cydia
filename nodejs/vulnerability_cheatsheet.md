# Vulnerabilities in Node.js and Securing

## Prototype Pollution

- Objects in javascript inherit their properties from an existing object or a prototype.

- i.e., this means that if an attacker can modify the prototype object and its properties, the prototype object can then affect the proplerties of all its parents.

- Polluting prototype leads to Cross-site scripting(XSS) attacks to Remote Code Execution(RCE).



## Cross-site script inclusion(XSSI)

- These attacks happen when malicious site includes javascript from a victim site to extract sensitive info from the script.



## Insecure puppeteer settings

- Puppteer is a Node library that allows applications to control a headless build of chrome or chromium programatically.
- Puppeteer helps automate user testing by mimicking activities that users can do in the browser. 
- e.g., form submissions, keyboard input, etc.


## Remote Code Execution(RCE)

- Remote code execution vulnerabilities or RCE happens when attackers execute their code in your machine.
- One of the ways this can happen is through code injection vulnerabilities.
- RCE happens when user input is concatentanated directly into executed code. So the application executes user input as code.
- One of the robust ways to prevent RCE is input validation in the form of an allowlist.


## Injection

- Code Injection is a type of injection issue. Injection happens when an application cannot properly distinguish between untrusted user data and code.
- 

### SQL Injection

- e.g., attacker injects data to manipulate sql commands. 
- When the application does not validate user input properly attackers can insert characters special to the SQL to mess with the query logic.
- One of the best way to prevent is to use parameterized statements, which makes SQL injection virtually impossible.



### Log Injection

### Mail Injection

### Template Injection(SSTI)

### Regex injection

- A regex injection attack or a regular expression denial of service attack(ReDOS) happens when an attacker provides a regex engine with a pattern that takes a long time to evaluatate.

### Header Injection

### Session Injection



## Host header poisioning

## Sensitive data leaks or Information leaks

## Authentication bypass

## Improper access control

## Directory traversal or path traversal

## Arbitrary file writes

## Denial of service attacks(DoS)

## Encryption vulnerabilities

## Mass assignment

## Open redirects

## Cross-site request forgery(CSRF)

- CSRF is a client side technique used to attack other users of a web application. 
- Attackers can send http requests that pretend to come from the victim, carrying out unwanted actionson victim's behalf.
- e.g., attacker can change your password or transfer money from your bank account without your permission.
- Can be prevented through a combination of CSRF tokens and samesite cookies.

## Server-side request forgery(SSRF)

- SSRF is a vulnerability that happens when an attacker is able to send requests on behalf of server.
- SSRF can bypass the firewall controls and gain access to internal services.


## Trust boundary violations

- Refers to where untrusted user input enters a controlled environment.
- e.g., an HTTP request is considered untrusted input until it has been validated by the server.
- There should be clear distinction between how you store, transport, and process
- A good way to prevent trust boundary violation is to never write untrusted input into session stores until it is verified.
